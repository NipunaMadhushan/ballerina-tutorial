# Session 3

## Overview 

- GraphQL with Ballerina
- Testing Ballerina code
- Ballerina connectors and package management
- Observability with Ballerina

These areas will be covered via an implementation of a GraphQL backend in Ballerina, for `Reviewed!`, a platform to review places.

## Backend implementation for `Reviewed!`

`Reviewed!` let's you 
- retrieve all places for which reviews can be done, with city, country, rating, and fee
- retrieve details of a specific place, including city, country, rating, fee, time zone, city population, and all the current reviews for the place
- retrieve all the reviews by a particular author
    - a review consists of a rating and review content for a particular place

### GraphQL diagram generated by Ballerina

![Overview](./backend/resources/graphql-diagram.jpeg)

### Developing the GraphQL backend

#### Level 0 - Initial data

- Branch - https://github.com/wso2con2024/ballerina-tutorial/tree/session-3-level-0

- Consists of in-memory data to get started with the GraphQL implementation.

- Three main entities: Place, Author, and Review

    ![Entity relationships](./backend/resources/er-diagram.jpeg)

- Use this to implement level 1.

    i. return all places with data in the places table - id, name, city, country, and entryFee

    ii. incorporate population and time zone information from https://public.opendatasoft.com/explore/dataset/geonames-all-cities-with-a-population-500/api/?disjunctive.country 

    - URL - https://public.opendatasoft.com/api/explore/v2.1/catalog/datasets
    - path - string `/geonames-all-cities-with-a-population-500/records?refine=name:${
        city}&refine=country:${country}` 

#### Level 1 - Record as output type

- Branch - https://github.com/wso2con2024/ballerina-tutorial/tree/session-3-level-1

- Consists of the GraphQL service implementation to retrieve `places` with additional city information, with records as output object types.

- But records, may not always be ideal if additional work is done to resolve fields, since it will be unnecessary if such a field is not requested. Similarly, records aren't ideal when there are relationships between objects and each object needs to be accessible via the other (e.g., review via place and place via review). For level 2, we will change record output type to an object output type.
